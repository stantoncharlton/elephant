<% active_jobs_count = jobs.where(:status => Job::ACTIVE).count(:id) %>
<% jobs_sql =  jobs.reorder('').where(:status => Job::ACTIVE).select("jobs.id").to_sql %>
<% active_failures_count = Failure.where("failures.job_id IN (#{jobs_sql})").count(:id) %>

   <div class="chart-block">
  <div class="chart-title">Active Jobs</div>
  <div class="donut-chart-div job-donut-chart-div">
    <div class="donut-text"><%= active_jobs_count %></div>
    <div class="percentage "></div>
  </div>
</div>

<div class="chart-block">
  <div class="chart-title">Closed in Last 5 Days</div>
  <div class="donut-chart-div job-donut-chart-div">
    <div class="donut-text"><%= jobs.where(:status => Job::CLOSED).where("jobs.close_date > ?", 5.days.ago).count(:id) %></div>
    <div class="percentage "></div>
  </div>
</div>

<div class="chart-block">
  <div class="chart-title">Active Failures</div>
  <div class="donut-chart-div job-donut-chart-div">
    <div class="donut-text chart-text-red failure-count"><%= active_failures_count %></div>
    <div class="percentage "></div>
  </div>
</div>

<div class="pull-right">
  <canvas id="canvas2" height="100" width="100"></canvas>
</div>

<div class="pull-right help-text">Pre/Post</div>


<script>

    var options = {
        animationEasing : "easeOutQuart"
    }


    var chartData2 = [
        {
            value: <%= 40 %>,
            color:"#62c462"
        },
        {
            value : <%= 60 %>,
            color : "#5bc0de"
        }]

    var myLine2 = new Chart(document.getElementById("canvas2").getContext("2d")).Doughnut(chartData2, options);

</script>