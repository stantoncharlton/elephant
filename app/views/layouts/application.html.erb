<!DOCTYPE html>
<html>
<head>
  <title><%= full_title(yield(:title)) %></title>
  <meta name="description=" content="Elephant is a solutions package created for the energy industry to achieve high quality processes.">
  <%= stylesheet_link_tag "application", media: "all" %>
  <%= javascript_include_tag "application" %>

  <% if signed_in? %>
      <% if Rails.env.dev? %>
          <script src='assets/javascript/mapbox.js'></script>
          <link href='assets/stylesheets/mapbox.css' rel='stylesheet'/>
      <% else %>
          <script src='//api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.js'></script>
          <link href='//api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.css' rel='stylesheet'/>
      <% end %>
  <% end %>

  <%= csrf_meta_tags %>
  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
  <link href='//api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.ie.css' rel='stylesheet'>
  <![endif]-->
</head>
<% if signed_in? %>
    <body class="body">
    <%= render 'layouts/header' %>

    <div id="wrong_browser_alert" class="hidden">
      <div class="alert alert-error2">
        <b>For security reasons, Google Chrome is the only supported web browser. Please use Google Chrome.</b>
        <%= link_to "Download Google Chrome", "http://www.google.com/chrome/", class: "activity-user-link red pull-right", :target => "_blank" %>
      </div>
    </div>

    <div class="container">

      <% flash.each do |key, value| %>
          <div class="alert alert-<%= key %>"><%= value %></div>
      <% end %>

      <%= yield %>

      <%= render 'layouts/footer' %>

      <div id="logged_out" class="hidden">
      </div>

      <%= debug(params) if Rails.env.development? %>
    </div>
    </body>
<% else %>
    <% if request.path == root_path %>
        <body class="body-non-signed-in">
    <% elsif request.path == features_path %>
        <body class="body-about-non-signed-in">
    <% elsif request.path == sales_path %>
        <body class="body-sales">
    <% elsif request.path == about_path %>
        <body class="body-about-non-signed-in">
    <% else %>
        <body class="body">

        <div class="container">
          <% flash.each do |key, value| %>
              <div class="alert alert-<%= key %>"><%= value %></div>
          <% end %>
    <% end %>

    <% if request.path != root_path %>
        <%= render 'layouts/header' %>
    <% end %>
    <div class="container-reset">
      <%= yield %>
    </div>

    <% if request.path != root_path && request.path != about_path %>
        </div>
    <% end %>

    </body>

<% end %>
</html>

<% if signed_in? %>
    <script type="text/javascript">
        (function ($) {
            $(document).ready(function () {

                setTimeout(function() {
                    $.ajax({
                        url: "/signin",
                        type: "GET",
                        dataType: "script"
                    });
                }, 1000 * 60 * 120);

                var isMobile = {
                    Android: function () {
                        return navigator.userAgent.match(/Android/i);
                    },
                    BlackBerry: function () {
                        return navigator.userAgent.match(/BlackBerry/i);
                    },
                    iOS: function () {
                        return navigator.userAgent.match(/iPhone|iPad|iPod/i);
                    },
                    Opera: function () {
                        return navigator.userAgent.match(/Opera Mini/i);
                    },
                    Windows: function () {
                        return navigator.userAgent.match(/IEMobile/i);
                    },
                    any: function () {
                        return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
                    }
                };

                if (isMobile.any()) {
                    // Mobile - take any browser
                } else {
                    var ie = $.browser.ielt9;
                    if (ie) {
                        $('#wrong_browser_alert').removeClass('hidden');
                    }
                }
            });
        }(jQuery));
    </script>
<% end %>

<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-42124443-1', 'go-elephant.com');
    ga('send', 'pageview');

</script>