<div id="bha" class="">
  <div class="bha-content" id="bha_<%= bha.id %>">

    <div class="page_header">
      <h1><%= bha.name %> - <%= bha.description %></h1>

      <% if signed_in? %>
          <div class="btn-group inline pull-right">
            <a class="custom-data-toggle-jobs" data-toggle="dropdown" href="#">
              Assembly Actions
            </a>
            <ul class="dropdown-menu">

              <li>
                <%= link_to "Edit", edit_bha_path(bha), class: "dropdown-menu-link" %>
              </li>
              <li class="divider"></li>
              <li>
                <%= link_to "Clone", new_bha_path(clone: true, bha: bha), class: "dropdown-menu-link" %>
              </li>
              <li class="divider"></li>
              <li>
                <%= link_to "Delete Assembly", bha, method: :delete,
                            data: {confirm: "Delete Assembly?"},
                            class: "dropdown-menu-link tooltip-info",
                            "data-placement" => "left",
                            "data-title" => "Delete assembly?" %>
              </li>
            </ul>
          </div>
      <% end %>
    </div>

    <div class='push-down'>
      <%= render 'drilling_logs/bha', bha: bha, drilling_log: DrillingLog.includes(document: {job: :well}).where("wells.id = ?", bha.job.well.id).first %>
    </div>

    <hr>

    <div class="">
      <p class="list-item-column list-item-column3 help-text">
        <span class='push-right-small'>Tool</span>
      </p>

      <p class="list-item-column2 list-item-column-short  help-text">
        ID <span class='help-text'>(in)</span>
      </p>

      <p class="list-item-column2 list-item-column-short  help-text">
        OD <span class='help-text'>(in)</span>
      </p>

      <p class="list-item-column2 list-item-column-short  help-text">
        Length <span class='help-text'>(in)</span>
      </p>

      <p class="list-item-column2 list-item-column-short  help-text">
        Total <span class='help-text'>(in)</span>
      </p>

      <p class="list-item-column2 list-item-column-count  help-text tooltip-info"
         data-title="Upward Connection">
        <i class="icon-arrow-up"></i>
        Up
      </p>


    </div>


    <% depth = 0.0 %>
    <div id="items" class="list">
      <% bha.bha_items.each do |item| %>

          <% if item.tool.present? %>
              <% depth = depth + item.length %>

              <div class="bha-line">

                <div class="push-right-small">
                  <div class="list-item-column list-item-column3 orange-text">
                    <%= render 'part_memberships/part_membership', part_membership: item.tool %>
                  </div>

                  <p class="list-item-column2 list-item-column-short">
                    <b><%= item.inner_diameter.to_s %></b>
                  </p>

                  <p class="list-item-column2 list-item-column-short ">
                    <b><%= item.outer_diameter.to_s %></b>
                  </p>

                  <p class="list-item-column2 list-item-column-short">
                    <b><%= item.length.to_s %></b>
                  </p>

                  <p class="list-item-column2 list-item-column-short ">
                    <b class='blue-text'><%= depth %></b>
                  </p>

                  <% if item.up >= 0 %>
                      <p class="list-item-column2 list-item-column-short help-text tooltip-info"
                         data-html="true"
                         data-title="Upward Connection: <%= item.up >= 0 ? BhaItem.connection_string(item.up) : "-" %>">
                        <%= item.up >= 0 ? BhaItem.connection_string(item.up) : "-" %>
                      </p>
                  <% end %>
                </div>

              </div>
          <% end %>
      <% end %>
    </div>

    <br>

    <div class='push-down pull-right'>
      <div class='inline-block'>
        <b>Bit to
          Sensor</b><span class='push-right-small blue-text'><%= bha.bit_to_sensor.present? ? bha.bit_to_sensor : "-" %></span>
      </div>
      <div class='inline-block push-right'>
        <b>Bit to
          Gamma</b><span class='push-right-small blue-text'><%= bha.bit_to_gamma.present? ? bha.bit_to_gamma : "-" %></span>
      </div>
    </div>

  </div>

  <div id="bha_loader" class="push-down center hidden inline">
    <br>

    <div class="">
      <span class="ajax-loading search-loading"><b>Loading..</b></span>
    </div>

    <br>
    <br>
  </div>


</div>